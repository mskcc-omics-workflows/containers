{
    "$schema": "http://json-schema.org/draft-07/schema",
    "title": "Docker",
    "description": "Validate output of docker inspect <IMAGE>",
    "type": "object",
    "properties": {
        "Architecture": {
            "type": "string",
            "pattern": "amd64"
        },
        "Os": {
            "type": "string",
            "pattern": "linux"
        },
        "Config": {
            "type":"object",
            "properties": {
                "Labels": {
                    "oneOf":[{
                        "type":"object",
                        "oneOf": [
                            {
                                "type":"object",
                                "properties": {
                                    "org.opencontainers.image.created": {
                                        "type": "string",
                                        "pattern": "^(\\d{4})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(?:T([01][0-9]|2[0-3])(:[0-5][0-9])(:[0-5][0-9])(?:\\.[0-9]+)?Z?)?$"
                                    },
                                    "org.opencontainers.image.authors": {"type": "string"},
                                    "org.opencontainers.image.url": {
                                        "type": "string",
                                        "pattern":"^(?:http://|https://|www\\.).*"
                                    },
                                    "org.opencontainers.image.documentation": {"type": "string"},
                                    "org.opencontainers.image.source": {"type": "string"},
                                    "org.opencontainers.image.version": {"type": "string"},
                                    "org.opencontainers.image.revision": {"type": "string"},
                                    "org.opencontainers.image.vendor": {"type": "string"},
                                    "org.opencontainers.image.licenses": {"type": "string"},
                                    "org.opencontainers.image.ref.name": {"type": "string"},
                                    "org.opencontainers.image.title": {"type": "string"},
                                    "org.opencontainers.image.description":{"type": "string"},
                                    "org.opencontainers.image.base.digest":{"type": "string"},
                                    "org.opencontainers.image.base.name": {"type": "string"}
                                },
                                "required": [
                                    "org.opencontainers.image.created",
                                    "org.opencontainers.image.authors",
                                    "org.opencontainers.image.url",
                                    "org.opencontainers.image.documentation",
                                    "org.opencontainers.image.source",
                                    "org.opencontainers.image.version",
                                    "org.opencontainers.image.revision",
                                    "org.opencontainers.image.vendor",
                                    "org.opencontainers.image.licenses",
                                    "org.opencontainers.image.ref.name",
                                    "org.opencontainers.image.title",
                                    "org.opencontainers.image.description",
                                    "org.opencontainers.image.base.digest",
                                    "org.opencontainers.image.base.name"
                                ],
                                "patternProperties": {
                                    "^org\\.opencontainers\\.image(?!\\.created$|\\.authors$|\\.url$|\\.documentation$|\\.source$|\\.version$|\\.revision$|\\.vendor$|\\.licenses$|\\.ref\\.name$|\\.title$|\\.description$|\\.base\\.digest$|\\.base\\.name$).*": { 
                                        "not": {}
                                    }
                                },
                                "additionalProperties": true              
                            },
                            {
                                "type":"object",
                                "patternProperties": {
                                    "^org\\.opencontainers\\.image.*": { 
                                        "not": {}
                                    }
                                },
                                "additionalProperties": true
                            }
                        ]
                    },
                    { "type":"null" }
                ]}
            },
            "required":[],
            "additionalProperties": true
        }
    },
    "required":["Architecture","Os","Config"],
    "additionalProperties": true
}